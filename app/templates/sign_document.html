{% extends 'base.html' %} {% block content %}
<div class="row">
  <div class="col-lg-12">
    <h1>Signed Document</h1>
    <div id="content" class="content-wrap1 content-center col-md-11 col-sm-11">
      <div class="genericErrors" id="genericErrorsDesc"></div>

      <!-- Preview the file -->
      <iframe
        id="viewer"
        frameborder="0"
        scrolling="auto"
        height="500px"
        width="100%"
        type="application/pdf"
      ></iframe>

      <button id="download_button" onclick="downloadPDF()">
        <i class="fa fa-download"></i> Download
      </button>
    </div>
  </div>
</div>

<script>
  let document_signed_value = "{{ document_signed_value }}";
  let document_content_type = "{{ document_content_type }}";
  let document_filename = "{{ document_filename }}";

  function downloadPDF(pdf) {
    const linkSource = `data:${document_content_type};base64,${document_signed_value}`;
    const downloadLink = document.createElement("a");
    downloadLink.href = linkSource;
    downloadLink.download = document_filename;
    downloadLink.click();
  }

  function loadDocumentViewer() {
    // Create a Blob object from the byte array
    const linkSource = `data:${document_content_type};base64,${document_signed_value}`;
    document.getElementById("viewer").src = linkSource;
    document.getElementById("btncheck").disabled = false;
  }

  window.onload = loadDocumentViewer();
</script>

{% endblock %}
